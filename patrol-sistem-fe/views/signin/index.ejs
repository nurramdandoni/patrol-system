<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.104.2">
  <title>Kinenta Guard</title>

  <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/sign-in/">





  <link href="../../assets/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="../assets/signin.css" rel="stylesheet">
</head>

<body class="text-center" style="font-family: 'Poppins', sans-serif">
    <div style="margin-top:172px;margin-left:12px; width: 390px; height: 844px; background-color: #FFFFFF;">
      <div
        style="width: 390px; height: 359px; 
        background: linear-gradient(180deg,rgba(3, 52, 129, 0.78) 0%,rgba(0, 0, 0, 0) 100%); 
        background-color: #0193E0; 
        border-radius: 0px 0px 16px 16px;
        box-shadow: 0px 8px 10.4px 0px rgba(0, 0, 0, 0.25);">
        <div class="row" style="display: flex; justify-content: center; align-items: center;">
          <image src="../assets/iconKinenta.png" alt="" style="width: 60px; border-radius: 16px; margin-top: 24px;">
        </div>
        <div class="row" style="text-align: center;font-weight: 600; font-size: 32px; color: #FFFFFF; margin-top: 19px;">
          <span>Kinenta Guard</span>
        </div>
        <div class="row" style="display: flex; justify-content: center; align-items: center;">
          <image src="../assets/iconPolice.png" alt="" style="width: 110px; border-radius: 16px; margin-top: 19px;">
        </div>
        <div class="row" style="text-align: center;font-weight: 400; font-size: 14px; color: #FFFFFF;margin-top: 28px;">
          <span>Welcome! Please enter username and password <br>to login to your account.</span>
        </div>
      </div>
      <!-- form -->
       <div class="row" style="display: flex; justify-content: center; align-items: center;margin-top: 42px;">
         <input type="text" id="username" placeholder="Username" style="width: 361px; height: 64px; border-radius: 48px; padding: 0 43px; border-color: thin solid gray;">
       </div>
       <div class="row" style="display: flex; justify-content: center; align-items: center;margin-top: 10px;">
          <input type="password" id="password" placeholder="Password" style="width: 361px; height: 64px; border-radius: 48px; padding: 0 43px; border-color: thin solid gray; margin-top: 16px;">
       </div>
       <div class="row" style="display: flex; justify-content: center; align-items: center;margin-top: 30px;">
        <button id="login" style="width: 361px; height: 64px; border-radius: 48px; background-color: #0193E0; color: white; font-weight: 600; font-size: 18px;">Login</button>
       </div>
       <div class="row" style="display: flex; justify-content: center; align-items: center;margin-top: 10px;">
        <p class="mt-5 mb-3 text-muted">&copy; 2025 - Support By Paylite</p>
       </div>
    </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $('#login').click(function () {
      fetch('<%= API_URL %>/auth/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'ngrok-skip-browser-warning': 'true'
        },
        body: JSON.stringify({
          username: $('#username').val(),
          password: $('#password').val()
        })
      })
        .then(async (response) => {
          // ðŸ‘‰ cek status code
          if (!response.ok) { // kalau bukan 2xx
            const errorText = await response.text(); // ambil pesan error mentah
            console.error('Server response:', errorText);
            if (response.status === 401) {
              alert('âŒ Login gagal: Username atau password salah');
            } else if (response.status === 404) {
              alert('âŒ User tidak ditemukan');
            } else {
              alert('âš ï¸ Terjadi kesalahan server (' + response.status + ')');
            }
            throw new Error('HTTP error ' + response.status);
          }

          // kalau sukses, parse JSON
          return response.json();
        })
        .then(data => {
          localStorage.setItem('token', data.token);
          localStorage.setItem('role', data.user.role);
          localStorage.setItem('profile', JSON.stringify(data.user.employee));
          localStorage.setItem('menus', JSON.stringify(data.user.menus));
          alert('âœ… Login berhasil');
          window.location.href = '/patrol-list';
        }).catch(error => {
          console.error('Error:', error);
        });
    });
  </script>
</body>

</html>